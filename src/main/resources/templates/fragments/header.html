<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>Header</title>
</head>
<body>

<header th:fragment="header">
    <section class="py-3 text-white text-center position-relative ">
        <nav class="navbar navbar-expand-lg navbar-transparent py-1 z-index-3 ">
            <div class="container">
                <div class="d-flex align-items-center justify-content-between w-100">
                    <!-- Empty space for balance -->
                    <div class="flex-grow-1"></div>

                    <!-- Title - centered -->
                    <h1 class="fw-bold fs-1 text-light mb-0">Anime Recommendation system</h1>

                    <!-- Menu and toggler section -->
                    <div class="flex-grow-1 d-flex justify-content-end align-items-center">
                        <button class="navbar-toggler shadow-none d-lg-none" type="button" data-bs-toggle="collapse"
                                data-bs-target="#navigation" aria-controls="navigation" aria-expanded="false"
                                aria-label="Toggle navigation">
                            <span class="navbar-toggler-icon mt-2">
                                <span class="navbar-toggler-bar bar1"></span>
                                <span class="navbar-toggler-bar bar2"></span>
                                <span class="navbar-toggler-bar bar3"></span>
                            </span>
                        </button>
                        <div class="collapse navbar-collapse" id="navigation">
                            <!-- Menu next to title -->
                            <ul class="navbar-nav navbar-nav-hover flex-row gap-4 mb-0 ms-4">
                                <li class="nav-item dropdown dropdown-hover">
                                    <a class="nav-link dropdown-toggle" id="dropdownMenuPages1" href="#"
                                       role="button"
                                       data-bs-toggle="dropdown" aria-expanded="false">
                                        <i class="ti ti-menu-2 nav-icon"></i>
                                        Menu
                                        <i class="ti ti-chevron-down nav-icon "></i>
                                    </a>
                                    <div class="dropdown-menu dropdown-menu-animation ms-n3 dropdown-md p-3 border-radius-lg mt-0 mt-lg-3"
                                         aria-labelledby="dropdownMenuPages1 ">
                                        <div class="d-none d-lg-block">
                                            <!-- welcome message -->
                                            <h6 class="text-primary fw-bold px-3 py-2 mb-0 d-flex align-items-center"
                                                style="font-size: 1rem; background-color: #f8f9fa; border-radius: 0.5rem;">
                                                ðŸ‘‹ Welcome
                                                <span sec:authorize="isAuthenticated()"
                                                      class="ms-1 text-dark fw-semibold"
                                                      th:text="${#authentication.name}"></span>
                                                <span sec:authorize="isAnonymous()"
                                                      class="ms-1 text-muted fw-semibold">Guest</span>
                                            </h6>
                                            <!--user menu-->
                                            <div sec:authorize="isAuthenticated()">
                                                <h6 class="dropdown-header text-dark font-weight-bolder d-flex align-items-center px-1">
                                                    Dashboard
                                                </h6>
                                                <a href="../pages/about-us.html" class="dropdown-item border-radius-md">
                                                    <span>Settings</span>
                                                </a>
                                                <a href="../pages/contact-us.html"
                                                   class="dropdown-item border-radius-md">
                                                    <span>Watchlist</span>
                                                </a>
                                                <h6 class="dropdown-header text-dark font-weight-bolder d-flex align-items-center px-1 ">
                                                    Account
                                                </h6>
                                                <form th:action="@{/logout}" method="post">
                                                    <button type="submit" class="dropdown-item border-radius-sm">
                                                        <span>Sign Out</span>
                                                    </button>
                                                </form>
                                            </div>
                                            <!--guest menu-->
                                            <div sec:authorize="isAnonymous()">
                                                <h6 class="dropdown-header text-dark font-weight-bolder d-flex align-items-center px-1 ">
                                                    Account
                                                </h6>
                                                <a th:href="@{/}" class="dropdown-item border-radius-sm">
                                                    <span>Sign In</span>
                                                </a>
                                            </div>
                                            <!-- end of the menu-->
                                        </div>
                                        <div class="d-lg-none">
                                            <!-- welcome message -->
                                            <h6 class="text-primary fw-bold px-3 py-2 mb-0 d-flex align-items-center"
                                                style="font-size: 1rem; background-color: #f8f9fa; border-radius: 0.5rem;">
                                                ðŸ‘‹ Welcome
                                                <span sec:authorize="isAuthenticated()"
                                                      class="ms-1 text-dark fw-semibold"
                                                      th:text="${#authentication.name}"></span>
                                                <span sec:authorize="isAnonymous()"
                                                      class="ms-1 text-muted fw-semibold">Guest</span>
                                            </h6>
                                            <!--user menu-->
                                            <div sec:authorize="isAuthenticated()">
                                                <h6 class="dropdown-header text-dark font-weight-bolder d-flex align-items-center px-1">
                                                    Dashboard
                                                </h6>
                                                <a href="../pages/about-us.html" class="dropdown-item border-radius-md">
                                                    <span>Settings</span>
                                                </a>
                                                <a href="../pages/contact-us.html"
                                                   class="dropdown-item border-radius-md">
                                                    <span>Watchlist</span>
                                                </a>
                                                <h6 class="dropdown-header text-dark font-weight-bolder d-flex align-items-center px-1 ">
                                                    Account
                                                </h6>
                                                <form th:action="@{/logout}" method="post">
                                                    <button type="submit" class="dropdown-item border-radius-sm">
                                                        <span>Sign Out</span>
                                                    </button>
                                                </form>
                                            </div>
                                            <!--guest menu-->
                                            <div sec:authorize="isAnonymous()">
                                                <h6 class="dropdown-header text-dark font-weight-bolder d-flex align-items-center px-1 ">
                                                    Account
                                                </h6>
                                                <a th:href="@{/}" class="dropdown-item border-radius-sm">
                                                    <span>Sign In</span>
                                                </a>
                                            </div>
                                            <!-- end of the menu-->
                                        </div>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </nav>
        <!--        header picture-->
        <div class="position-absolute top-0 start-0 w-100 h-100" style="
        background-image: url('/assets/image/ian-valerio-road-header-unsplash.jpg');
        background-size: cover;
        background-position: center;
        filter: brightness(1); /* Adjust brightness to make text pop */
        z-index: 1;"></div>

        <div class="container position-relative  z-index-2 ">
            <p class="lead mt-3">Explore your next obsession from other users' obsession.</p>
            <!--           search form-->
            <form class="mt-4" role="search" th:object="${anime}" th:action="@{${action}}" method="post">
                <div class="row justify-content-center align-items-end g-2">
                    <div class="col-md-5">
                        <div class="form-group mb-0 position-relative">
                            <label for="animeName" class="form-label text-white visually-hidden">Search again:</label>
                            <input type="text"
                                   id="animeName"
                                   th:field="*{animeName}"
                                   class="form-control bg-light text-white border-0 shadow-sm ps-4 py-3 rounded-pill"
                                   placeholder="Search for a different anime..."
                                   aria-describedby="animeNameError"/>
                        </div>
                    </div>
                    <div class="col-auto">
                        <button type="submit"
                                class="btn btn-lg btn-success fw-bold mb-0 text-dark rounded-pill shadow-sm">Search
                        </button>
                    </div>
                    <div id="animeNameError"
                         th:if="${#fields.hasErrors('animeName')}"
                         class="bg-danger text-white small p-1 mt-1 text-center rounded position-absolute top-100 start-0 w-100"
                         style="z-index: 10;">
                        <span th:errors="*{animeName}"></span>
                    </div>
                    <div th:if="${#fields.hasAnyErrors()}">
                        <ul>
                            <li th:each="err : ${#fields.allErrors()}" th:text="${err}"/>
                        </ul>
                    </div>
                    <!-- Advanced Options Toggle -->
                    <div class="mt-4 text-center">
                        <div class="form-check form-switch d-inline-flex align-items-center">
                            <input class="form-check-input me-2" type="checkbox" id="toggleAdvanced"
                                   style="transform: scale(1.2); accent-color: #28a745;">
                            <label class="form-check-label text-white fw-500" for="toggleAdvanced">
                                <i class="ti ti-settings me-1"></i>
                                Show Advanced Options
                            </label>
                        </div>
                    </div>
                </div>
                <!-- Collapsible Advanced Options -->
                <div class="collapse mt-4" id="advancedOptions">
                    <div class="card bg-light bg-opacity-90 border-0 shadow-lg rounded-4 p-4 mx-auto"
                         style="max-width: 600px; backdrop-filter: blur(10px);">
                        <div class="card-body">
                            <h6 class="text-dark fw-bold mb-3 text-center">
                                <i class="ti ti-adjustments-horizontal me-2"></i>
                                Fine-tune Your Recommendations
                            </h6>
                            <!--sliders-->
                            <div class=" row mb-4">
                                <!-- Minimum Rating Slider -->
                                <div class="col-md-6">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <label for="minRating" class="form-label text-dark mb-0 fw-500">
                                            <i class="ti ti-star-filled text-warning me-1"></i>
                                            Minimum Input Anime User Rating
                                        </label>
                                        <span class="badge bg-warning text-dark px-3 py-2 rounded-pill">
                            <span id="minRatingValue" th:text="${anime.minRating()}"></span>/10
                        </span>
                                    </div>
                                    <input type="range"
                                           class="form-range"
                                           min="1"
                                           max="10"
                                           th:field="*{minRating}"
                                           style="accent-color: #ffc107;">
                                    <div class="d-flex justify-content-between text-muted small mt-1">
                                        <span>1 (Include all)</span>
                                        <span>10 (Only perfect scores)</span>
                                    </div>
                                </div>
                                <!-- Max Users Slider -->
                                <div class="col-md-6">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <label for="maxUsers" class="form-label text-dark mb-0 fw-500">
                                            <i class="ti ti-users me-1"></i>
                                            Max Users to Analyze
                                        </label>
                                        <span class="badge bg-info px-3 py-2 rounded-pill">
                            <span id="maxUsersValue" th:text="${anime.maxUsers()}"></span> users
                        </span>
                                    </div>
                                    <input type="range"
                                           class="form-range"
                                           min="100"
                                           max="2000"
                                           th:field="*{maxUsers}"
                                           step="50"
                                           style="accent-color: #17a2b8;">
                                    <div class="d-flex justify-content-between text-muted small mt-1">
                                        <span>100 (Faster)</span>
                                        <span>2000 (More comprehensive)</span>
                                    </div>
                                </div>
                            </div>
                            <!--genre / type filter -->
                            <h6 class="text-dark fw-bold mb-3">
                                <i class="ti ti-tag me-2"></i>
                                Genre & Type Filters
                            </h6>
                            <div class="form-check p-2 rounded" style="background: rgba(40, 167, 69, 0.1);">
                                <input class="form-check-input me-2"
                                       type="checkbox"
                                       th:field="*{onlyInAnimeGenres}"
                                       style="accent-color: #28a745; ">
                                <label class="form-check-label text-dark fw-500 fst-italic" for="onlyInAnimeGenres">
                                    Only same genres as input anime
                                </label>
                            </div>
                            <div class="row mb-4">
                                <div class="col-md-6">
                                    <label class="form-label fw-500 text-dark">Genres</label>
                                    <select class="form-select" multiple name="genres">
                                        <option>Action</option>
                                        <option>Adventure</option>
                                        <option>Romance</option>
                                        <option>Comedy</option>
                                        <option>Drama</option>
                                        <!-- ... -->
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label fw-500 text-dark">Type</label>
                                    <select class="form-select" multiple name="type">
                                        <option value="">Any</option>
                                        <option>TV</option>
                                        <option>Movie</option>
                                        <option>OVA</option>
                                        <option>ONA</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Content Filters -->
                            <div class="mb-3">
                                <label class="form-label text-dark mb-3 fw-500">
                                    <i class="ti ti-shield-check me-1"></i>
                                    Content Filters
                                </label>
                                <div class="row g-2">
                                    <div class="col-6">
                                        <div class="form-check p-3 border rounded-3 h-100"
                                             style="background: rgba(40, 167, 69, 0.1); border-color: #28a745 !important;">
                                            <input class="form-check-input" type="checkbox" id="excludeAdult"
                                                   name="excludeAdult" checked style="accent-color: #28a745;">
                                            <label class="form-check-label text-dark fw-500" for="excludeAdult">
                                                <i class="ti ti-shield-x text-success me-1"></i>
                                                Exclude Adult Content
                                            </label>
                                            <small class="text-muted d-block mt-1">Hide mature/adult anime</small>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="form-check p-3 border rounded-3 h-100"
                                             style="background: rgba(255, 193, 7, 0.1); border-color: #ffc107 !important;">
                                            <input class="form-check-input" type="checkbox" id="excludeEcchi"
                                                   name="excludeEcchi" style="accent-color: #ffc107;">
                                            <label class="form-check-label text-dark fw-500" for="excludeEcchi">
                                                <i class="ti ti-eye-off text-warning me-1"></i>
                                                Exclude Ecchi
                                            </label>
                                            <small class="text-muted d-block mt-1">Hide suggestive content</small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Quick Presets -->
                            <div class="text-center">
                                <small class="text-muted mb-2 d-block">Quick Presets:</small>
                                <div class="btn-group" role="group">
                                    <button type="button" class="btn btn-outline-success btn-sm rounded-pill me-2"
                                            onclick="setPreset('fast')">
                                        <i class="ti ti-bolt me-1"></i>Fast
                                    </button>
                                    <button type="button" class="btn btn-outline-primary btn-sm rounded-pill me-2"
                                            onclick="setPreset('balanced')">
                                        <i class="ti ti-balance me-1"></i>Balanced
                                    </button>
                                    <button type="button" class="btn btn-outline-info btn-sm rounded-pill"
                                            onclick="setPreset('comprehensive')">
                                        <i class="ti ti-search me-1"></i>Comprehensive
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </section>
</header>
</body>
</html>