<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Anime Recommendations</title>
    <!-- Theme CSS -->

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link th:href="@{/assets/css/material-kit.min.css}" rel="stylesheet">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet">

    <!-- Icons -->
    <link th:href="@{/assets/css/nucleo-icons.css}" rel="stylesheet">
    <script src="https://kit.fontawesome.com/42d5adcbca.js" crossorigin="anonymous"></script>


</head>
<body class="bg-light">

<main>
    <!-- Hero Section -->
    <section class="py-5 text-white text-center position-relative overflow-hidden">
        <!--        header picture-->
        <div class="position-absolute top-0 start-0 w-100 h-100" style="
        background-image: url('/assets/image/ian-valerio-road-header-unsplash.jpg');
        background-size: cover;
        background-position: center;
        filter: brightness(1); /* Adjust brightness to make text pop */
        z-index: 1;
    "></div>

        <div class="container position-relative z-index-2">
            <h1 class="fw-bold fs-1 text-light">Anime Recommendation sytsem</h1>

            <p class="lead mt-3">Explore your next obsession from other users' obsession.</p>

            <!--           search form-->
            <form class="mt-4" role="search" th:object="${anime}" th:action="@{/result/submit}" method="post">
                <div class="row justify-content-center align-items-end g-2">
                    <div class="col-md-5">
                        <div class="form-group mb-0 position-relative">
                            <label for="animeName" class="form-label text-white visually-hidden">Search again:</label>
                            <input type="text"
                                   id="animeName"
                                   th:field="*{animeName}"
                                   class="form-control bg-light text-white border-0 shadow-sm ps-4 py-3 rounded-pill"
                                   placeholder="Search for a different anime..."
                                   aria-describedby="animeNameError"/>
                            <div id="animeNameError"
                                 th:if="${#fields.hasErrors('animeName')}"
                                 class="bg-danger text-white small p-1 mt-1 text-center rounded position-absolute top-100 start-0 w-100"
                                 style="z-index: 10;">
                                <span th:errors="*{animeName}"></span>
                            </div>
                        </div>
                    </div>
                    <div class="col-auto">
                        <button type="submit"
                                class="btn btn-lg btn-success fw-bold mb-0 text-dark rounded-pill shadow-sm">Search
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </section>

    <!-- Recommendations Section -->
    <section class="py-5">
        <div class="container">
            <h2 class="mb-4"
                th:text="'Anime Recommendations for: ' + ${#strings.listJoin(recommendations.inputAnimeNames, ', ')}"></h2>
            <div class="row g-4">
                <div th:each="recommend : ${recommendations.getRecommendedAnime()}"
                     class="col-sm-6 col-md-4 col-lg-3">
                    <div class="card shadow-sm h-100">
                        <!-- Image -->
                        <a th:href="@{'https://myanimelist.net/anime/' + ${recommend.animeId} + '/'}">
                            <img th:src="${recommend.animeInfo.imageURL}"
                                 th:alt="${recommend.animeInfo.name}"
                                 class="card-img-top img-fluid">
                        </a>

                        <!-- Card Body -->
                        <div class="card-body d-flex flex-column flex-grow-1 ">
                            <h5 class="card-title mb-3" th:text="${recommend.animeInfo.name}"></h5>

                            <div class="d-flex flex-column justify-content-center flex-grow-1">
                                <div class="card-text d-flex flex-row justify-content-between align-items-start ">
                                    <!-- Left side: Recommendation text -->
                                    <div class="align-self-center">
                                        <p class="text-muted small mb-0"
                                           th:text="'Recommended because rated by: ' + ${#numbers.formatDecimal(recommend.percentageOccurrences, 1, 2)} + '%'">
                                        </p>
                                    </div>

                                    <!-- Right side: Genre pills aligned to right -->
                                    <div class="d-flex flex-column align-items-end ms-auto">
                                        <span class="badge bg-secondary mb-2">Genres:</span>
                                        <span th:each="genre : ${recommend.animeInfo.genres}"
                                              class="badge rounded-pill bg-secondary mb-1"
                                              th:text="${genre}"></span>
                                    </div>
                                </div>
                            </div>
                        </div>

                            <!-- Badges -->
                            <div class="d-flex justify-content-between mt-3 ">
                                <span class="badge bg-info"
                                      th:text="'Avg: ' + ${#numbers.formatDecimal(recommend.getAverageRating(), 1, 2)}">
                                </span>
                                <span class="badge bg-primary"
                                      th:text="'MAL: ' + ${recommend.animeInfo.score}">
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
    </section>
</main>
<footer class="bg-dark text-white py-4 text-center">
    <div class="container">
        <p class="mb-1">
            Photo by <a
                href="https://unsplash.com/@iangvalerio?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash"
                class="text-white text-decoration-none">Ian Valerio</a> on <a
                href="https://unsplash.com/photos/aerial-view-photography-of-road-between-highrise-building-CAFq0pv9HjY?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash"
                class="text-white text-decoration-none">Unsplash</a>
            | Made with Bootstrap & Material Kit | Jan Koc√°bek &copy; 2025
        </p>
    </div>
</footer>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="/assets/js/core/popper.min.js"></script>
<script src="/assets/js/core/bootstrap.min.js"></script>
<script src="/assets/js/material-kit.min.js"></script>
</body>
</html>
